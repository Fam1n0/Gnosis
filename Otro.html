<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Sator Speaker</title><style>body{margin:0;overflow:hidden;display:flex;justify-content:center;align-items:center;height:100vh;background-color:black}canvas{position:absolute;top:0;left:0;width:100%;height:100%;}.controls{position:absolute;top:10px;left:10px;z-index:10;display:flex;flex-direction:column;gap:10px;color:white}.hidden{display:none}button{font-size:16px;padding:10px;cursor:pointer}</style></head><body><canvas id="chakraCanvas"></canvas><div id="controls" class="controls hidden"><button id="fullscreenButton">Toggle Fullscreen</button><button id="saveButton">Save Image</button><input type="file" id="imageInput" accept="image/*"></div><script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.4.0/p5.js"></script><script>document.addEventListener("DOMContentLoaded",function(){const chakraCanvas=document.getElementById('chakraCanvas');const ctx=chakraCanvas.getContext('2d');const fullscreenButton=document.getElementById('fullscreenButton');const saveButton=document.getElementById('saveButton');const imageInput=document.getElementById('imageInput');const controls=document.getElementById('controls');let imgData, imgWidth, imgHeight;function resizeCanvas(){chakraCanvas.width=window.innerWidth;chakraCanvas.height=window.innerHeight;}resizeCanvas();window.addEventListener('resize',resizeCanvas);fullscreenButton.addEventListener('click',function(){if(!document.fullscreenElement){document.documentElement.requestFullscreen();}else if(document.exitFullscreen){document.exitFullscreen();}});saveButton.addEventListener('click',function(){const link=document.createElement('a');const timestamp=new Date().toISOString().replace(/[:.]/g,'-');const canvas=document.createElement('canvas');canvas.width=chakraCanvas.width;canvas.height=chakraCanvas.height;const tempCtx=canvas.getContext('2d');tempCtx.fillStyle='black';tempCtx.fillRect(0,0,canvas.width,canvas.height);tempCtx.drawImage(chakraCanvas,0,0);link.download=`chakra_visualization_${timestamp}.png`;link.href=canvas.toDataURL('image/png',1.0);link.click();});chakraCanvas.addEventListener('click',function(){controls.classList.toggle('hidden');});imageInput.addEventListener('change',function(event){const file=event.target.files[0];const reader=new FileReader();reader.onload=function(e){const img=new Image();img.onload=function(){imgWidth=img.width;imgHeight=img.height;const tempCanvas=document.createElement('canvas');tempCanvas.width=imgWidth;tempCanvas.height=imgHeight;const tempCtx=tempCanvas.getContext('2d');tempCtx.drawImage(img,0,0,imgWidth,imgHeight);imgData=tempCtx.getImageData(0,0,imgWidth,imgHeight);applyEdgeDetection();};img.src=e.target.result;};reader.readAsDataURL(file);});function applyEdgeDetection(){const grayData=[];const sobelData=[];for(let i=0;i<imgData.data.length;i+=4){const avg=(imgData.data[i]+imgData.data[i+1]+imgData.data[i+2])/3;grayData.push(avg);}const sobelKernelX=[[-1,0,1],[-2,0,2],[-1,0,1]];const sobelKernelY=[[-1,-2,-1],[0,0,0],[1,2,1]];for(let y=0;y<imgHeight;y++){for(let x=0;x<imgWidth;x++){const pixelX=(sobelKernelX[0][0]*grayData[((y-1)*imgWidth+(x-1))])+(sobelKernelX[0][1]*grayData[((y-1)*imgWidth+x)])+(sobelKernelX[0][2]*grayData[((y-1)*imgWidth+(x+1))])+(sobelKernelX[1][0]*grayData[(y*imgWidth+(x-1))])+(sobelKernelX[1][1]*grayData[(y*imgWidth+x)])+(sobelKernelX[1][2]*grayData[(y*imgWidth+(x+1))])+(sobelKernelX[2][0]*grayData[((y+1)*imgWidth+(x-1))])+(sobelKernelX[2][1]*grayData[((y+1)*imgWidth+x)])+(sobelKernelX[2][2]*grayData[((y+1)*imgWidth+(x+1))]);const pixelY=(sobelKernelY[0][0]*grayData[((y-1)*imgWidth+(x-1))])+(sobelKernelY[0][1]*grayData[((y-1)*imgWidth+x)])+(sobelKernelY[0][2]*grayData[((y-1)*imgWidth+(x+1))])+(sobelKernelY[1][0]*grayData[(y*imgWidth+(x-1))])+(sobelKernelY[1][1]*grayData[(y*imgWidth+x)])+(sobelKernelY[1][2]*grayData[(y*imgWidth+(x+1))])+(sobelKernelY[2][0]*grayData[((y+1)*imgWidth+(x-1))])+(sobelKernelY[2][1]*grayData[((y+1)*imgWidth+x)])+(sobelKernelY[2][2]*grayData[((y+1)*imgWidth+(x+1))]);const magnitude=Math.sqrt((pixelX*pixelX)+(pixelY*pixelY));sobelData.push(magnitude,magnitude,magnitude,255);}}const edgeImageData=new ImageData(new Uint8ClampedArray(sobelData),imgWidth,imgHeight);const tempCanvas=document.createElement('canvas');tempCanvas.width=imgWidth;tempCanvas.height=imgHeight;const tempCtx=tempCanvas.getContext('2d');tempCtx.putImageData(edgeImageData,0,0);imgData=tempCtx.getImageData(0,0,imgWidth,imgHeight);animateWaves();}function animateWaves(){const p5Instance=new p5((sketch)=>{let colors, points;sketch.setup=()=>{sketch.createCanvas(chakraCanvas.width,chakraCanvas.height);sketch.noFill();sketch.strokeWeight(2);colors=[sketch.color(255,0,0),sketch.color(0,255,0),sketch.color(0,0,255)];points=[];for(let i=0;i<100;i++){const angle=sketch.random(0,sketch.TWO_PI);const radius=sketch.random(20,100);points.push({x:sketch.width/2+radius*sketch.cos(angle),y:sketch.height/2+radius*sketch.sin(angle),angle:angle,step:sketch.random(0.01,0.05)});}sketch.frameRate(30);};sketch.draw=()=>{sketch.clear();sketch.image(chakraCanvas,0,0,sketch.width,sketch.height);for(let i=0;i<points.length;i++){const p=points[i];p.x+=sketch.cos(p.angle)*p.step*50;p.y+=sketch.sin(p.angle)*p.step*50;if(p.x<0||p.x>sketch.width||p.y<0||p.y>sketch.height){p.x=sketch.width/2;p.y=sketch.height/2;}sketch.stroke(colors[i%3]);sketch.point(p.x,p.y);p.angle+=sketch.random(-0.01,0.01);p.step+=sketch.random(-0.001,0.001);}}},chakraCanvas);}animateWaves();});</script></body></html>
